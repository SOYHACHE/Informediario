<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Informe de Seguridad</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#4CAF50">

<style>
body { font-family: Arial, sans-serif; padding: 15px; }
h2 { margin-top: 25px; }

.row {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 6px;
}

input[type="number"], input[type="text"] {
  padding: 6px;
  width: 120px;
}

button {
  padding: 10px;
  margin-top: 10px;
  width: 100%;
}
</style>
</head>

<body>

<h2>Pallet adeudados <input type="number" id="pallets" min="0"></h2>

<h2>Seguridad</h2>
<textarea id="seguridad" rows="4" style="width:100%"></textarea>

<h2>Balance de changos</h2>
<div class="row">
  F√≠sico <input type="number" id="changosFisico">
  Te√≥rico <input type="number" id="changosTeorico">
</div>
<div id="changosResultado"></div>

<h2>Enviar a</h2>

<div class="row">
  <input type="checkbox" name="destino" value="1154156494"> Supervisor
</div>
<div class="row">
  <input type="checkbox" name="destino" value="1132560237"> Gerencia
</div>
<div class="row">
  <input type="checkbox" name="destino" value="2617224497"> Seguridad
</div>

<div class="row">
  Manual: <input type="text" id="manual" placeholder="Ej: 1122334455">
</div>

<button id="enviar">Enviar WhatsApp</button>
<button id="vaciar">Vaciar</button>

<script>
// ================== SERVICE WORKER ==================
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("service-worker.js");
}

// ================== CHANGOS ==================
const fisico = document.getElementById("changosFisico");
const teorico = document.getElementById("changosTeorico");
const resultado = document.getElementById("changosResultado");

function calcularChangos() {
  if (fisico.value && teorico.value) {
    resultado.textContent = "Diferencia: " + (fisico.value - teorico.value);
  } else {
    resultado.textContent = "";
  }
}
fisico.oninput = calcularChangos;
teorico.oninput = calcularChangos;

// ================== ENVIAR ==================
document.getElementById("enviar").onclick = () => {

  const pallets = document.getElementById("pallets").value;
  const seguridad = document.getElementById("seguridad").value;

  let msg = "üìã *Informe de Seguridad*\n";

  if (pallets) msg += `Pallet adeudados: ${pallets}\n`;
  if (seguridad) msg += `Seguridad: ${seguridad}\n`;
  if (resultado.textContent) msg += resultado.textContent + "\n";

  // === obtener destino ===
  let tel = "";

  const seleccionado = document.querySelector('input[name="destino"]:checked');
  const manual = document.getElementById("manual").value.trim();

  if (seleccionado) {
    tel = "+549" + seleccionado.value;
  } else if (manual) {
    tel = "+549" + manual;
  } else {
    alert("Seleccion√° un destinatario o ingres√° uno manual");
    return;
  }

  window.open(`https://wa.me/${tel}?text=${encodeURIComponent(msg)}`);
};

// ================== VACIAR ==================
document.getElementById("vaciar").onclick = () => {
  document.querySelector("textarea").value = "";
  document.querySelectorAll("input").forEach(i => i.value = "");
  resultado.textContent = "";
};
</script>

</body>
</html>
